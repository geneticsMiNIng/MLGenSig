---
title: "Wykresy - volcanoplots"
author: "Aleksandra Dąbrowska"
date: "17 May 2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Weźmy pierwsze 500 genów o najbardziej zróżnicowanej ekspresji i metylacji.
```{r,echo=FALSE}
library(MetExpR)
library(plyr)

ekspresja_500 <-test_expr_brca[order(test_expr_brca$pval, decreasing= F),]
ekspresja_500 <- ekspresja_500[c(1:500),]


metylacja_500 <-test_met_brca[order(test_met_brca$pval, decreasing= F),]
metylacja_500 <- metylacja_500[c(1:500),]

x <- ekspresja_500[which(ekspresja_500$id %in% metylacja_500$id),]

genes <- x$id


```

W obu zbiorach danych powtarza się 19 genów.



```{r,fig.height=15,fig.width=30,echo=FALSE,warning=FALSE}
library(MetExpR)

genes <- c("BRCA1","BRCA2")
condition.m <-ifelse(BRCA_methylation_all$SUBTYPE=="LumA","LumA","other")
condition.e <-ifelse(BRCA_mRNAseq_all$SUBTYPE=="LumA","LumA","other")

volcano_plot(test_expr_brca, ngen=genes)
volcano_plot(test_met_brca, ngen=genes)

plot <- list()
for (i in 1:length(genes)){
  plot[[i]] <- genereg_vs_met(BRCA_methylation_all[,-1], condition.m, gene=genes[i])
  }


plot[[1]]
plot[[2]]
```